# Glazer盆底肌评估系统使用说明

## 系统概述

本系统是一套完整的Glazer盆底肌电评估解决方案，包含三个核心模块：

1. **评估计算器** (`glazer_assessment_calculator.py`) - 基于曲线公式的精确打分算法
2. **建议系统** (`glazer_recommendation_system.py`) - 智能化训练建议和改善方案
3. **集成系统** (`glazer_integrated_system.py`) - 完整的评估流程和报告生成

## 核心功能

### 1. 评估计算模块

#### 评估阶段
- **前静息阶段**：评估基础肌电水平和稳定性
- **快肌纤维阶段**：评估快速收缩能力和反应速度
- **慢肌纤维阶段**：评估持续收缩能力和稳定性
- **耐力测试阶段**：评估长时间工作能力和抗疲劳性
- **后静息阶段**：评估运动后恢复能力

#### 计算指标
- **均方根值(RMS)**：肌电活动强度
- **变异系数(CV)**：肌电活动稳定性
- **收缩反应时间**：神经肌肉反应速度
- **恢复时间**：肌肉放松能力
- **疲劳指数**：抗疲劳能力

#### 评分算法
- **曲线型评分**：非线性评分函数，更符合生理特性
- **分级标准**：0-100分制，分为很差、较差、及格、良好、优秀五个等级
- **权重分配**：各阶段和指标采用不同权重，体现重要性差异

### 2. 建议系统模块

#### 问题分析规则

**前静息阶段问题识别：**
- 平均值 > 8μV：肌肉紧张
- 变异性 > 0.5：控制不稳定

**快肌纤维阶段问题识别：**
- 最大值 < 30μV：收缩力不足
- 最大值 > 150μV：过度激活/代偿
- 上升时间 > 1.0s：反应速度慢
- 恢复时间 > 1.0s：放松困难

**慢肌纤维阶段问题识别：**
- 平均值 < 25μV：持续收缩能力不足
- 变异性 > 0.4：稳定性差
- 时间参数 > 1.5s：激活/放松过程慢

**耐力测试阶段问题识别：**
- 平均值 < 20μV：耐力不足
- 疲劳指数 < 0.7：抗疲劳能力差
- 疲劳指数 > 1.3：可能存在代偿
- 变异性 > 0.3：长时间稳定性差

**后静息阶段问题识别：**
- 恢复比值 > 1.5：恢复能力不足

#### 训练建议规则

**基于得分等级的建议强度：**
- **0-40分（很差/较差）**：立即关注，每日2-3次训练
- **60-70分（及格）**：中期目标，隔日训练
- **70-85分（良好）**：长期改善，每周2-3次
- **85分以上（优秀）**：维持训练，每周1-2次

**优先级计算：**
```
优先级 = 阶段重要性权重 × (100 - 得分) / 100
```

**阶段重要性权重：**
- 快肌纤维：30%
- 慢肌纤维：30%
- 耐力测试：20%
- 前静息：10%
- 后静息：10%

### 3. 集成系统模块

#### 完整评估流程
1. **数据输入**：原始肌电测量数据
2. **得分计算**：各阶段和总体得分
3. **问题分析**：识别具体问题和原因
4. **建议生成**：个性化训练建议
5. **计划制定**：分阶段训练计划
6. **报告输出**：格式化评估报告

#### 使用模式
- **交互式评估**：单个用户实时评估
- **批量处理**：多用户数据批量分析
- **对比分析**：群体数据统计分析

## 使用方法

### 1. 单个评估

```python
from glazer_integrated_system import GlazerIntegratedSystem

# 创建系统实例
system = GlazerIntegratedSystem()

# 准备测量数据
raw_data = {
    'pre_avg': 6.5,           # 前静息平均值(μV)
    'pre_var': 0.25,          # 前静息变异性
    'fast_max': 35.0,         # 快肌纤维最大值(μV)
    'fast_rise': 1.2,         # 快肌纤维上升时间(s)
    'fast_recovery': 0.8,     # 快肌纤维恢复时间(s)
    'tonic_avg': 38.0,        # 慢肌纤维平均值(μV)
    'tonic_rise': 0.8,        # 慢肌纤维上升时间(s)
    'tonic_recovery': 1.1,    # 慢肌纤维恢复时间(s)
    'tonic_var': 0.28,        # 慢肌纤维变异性
    'endurance_avg': 28.0,    # 耐力测试平均值(μV)
    'endurance_var': 0.22,    # 耐力测试变异性
    'endurance_fatigue': 0.85, # 耐力测试后10秒比值
    'post_avg': 8.2,          # 后静息平均值(μV)
    'post_var': 0.35          # 后静息变异性
}

# 处理评估
result = system.process_single_assessment(raw_data)

# 输出报告
print(result['formatted_report'])
```

### 2. 批量处理

```python
# 批量处理数据文件
results = system.process_batch_assessment('data_file.txt')

# 导出结果
system.export_results(results, './output')
```

### 3. 交互式评估

```bash
python3 glazer_integrated_system.py
# 选择模式 1 进入交互式评估
```

## 数据格式要求

### 输入数据格式
所有数值型数据，包含以下字段：
- `pre_avg`: 前静息平均值(μV)
- `pre_var`: 前静息变异性
- `fast_max`: 快肌纤维最大值(μV)
- `fast_rise`: 快肌纤维上升时间(s)
- `fast_recovery`: 快肌纤维恢复时间(s)
- `tonic_avg`: 慢肌纤维平均值(μV)
- `tonic_rise`: 慢肌纤维上升时间(s)
- `tonic_recovery`: 慢肌纤维恢复时间(s)
- `tonic_var`: 慢肌纤维变异性
- `endurance_avg`: 耐力测试平均值(μV)
- `endurance_var`: 耐力测试变异性
- `endurance_fatigue`: 耐力测试后10秒比值
- `post_avg`: 后静息平均值(μV)
- `post_var`: 后静息变异性

### 输出报告格式
- **总体评估**：总分和等级
- **各阶段得分**：5个阶段的详细得分
- **问题分析**：识别的具体问题
- **训练建议**：个性化改善建议
- **训练计划**：分阶段训练安排

## 评分标准

### 得分等级
- **85-100分**：优秀 (excellent)
- **70-84分**：良好 (good)
- **60-69分**：及格 (fair)
- **40-59分**：较差 (poor)
- **0-39分**：很差 (very_poor)

### 参考值

| 指标 | 满分值 | 及格值 | 类型 |
|------|--------|--------|---------|
| 前静息平均值 | 0μV | 4μV | 越小越好 |
| 前静息变异性 | 0 | 0.2 | 越小越好 |
| 快肌纤维最大值 | 60μV | 40μV | 越大越好 |
| 快肌纤维上升时间 | 0s | 0.5s | 越小越好 |
| 快肌纤维恢复时间 | 0s | 0.5s | 越小越好 |
| 慢肌纤维平均值 | 45μV | 35μV | 越大越好 |
| 慢肌纤维上升时间 | 0s | 1s | 越小越好 |
| 慢肌纤维恢复时间 | 0s | 1s | 越小越好 |
| 慢肌纤维变异性 | 0 | 0.2 | 越小越好 |
| 耐力测试平均值 | 40μV | 30μV | 越大越好 |
| 耐力测试变异性 | 0 | 0.2 | 越小越好 |
| 耐力测试后10秒比值 | 1.0 | 0.8/1.2 | 高斯分布 |
| 后静息平均值 | 0μV | 4μV | 越小越好 |
| 后静息变异性 | 0 | 0.2 | 越小越好 |

## 系统特点

### 1. 科学性
- 基于Glazer原始协议设计
- 采用曲线型评分函数，更符合生理特性
- 权重分配基于临床重要性

### 2. 个性化
- 针对不同问题提供专门建议
- 基于得分等级制定训练强度
- 考虑优先级的训练计划

### 3. 实用性
- 支持单个和批量评估
- 提供多种输出格式
- 交互式和自动化两种模式

### 4. 可扩展性
- 模块化设计，易于维护和扩展
- 参数可配置，适应不同需求
- 支持自定义规则和建议

## 注意事项

1. **数据质量**：确保输入数据的准确性和完整性
2. **参考值适用性**：参考值基于一般人群，特殊人群可能需要调整
3. **建议个性化**：系统建议需要结合个人具体情况
4. **专业指导**：建议在专业人员指导下使用

## 技术支持

如有技术问题或改进建议，请联系开发团队。

---

*本系统基于Glazer盆底肌电评估协议开发，仅供科研和临床参考使用。*